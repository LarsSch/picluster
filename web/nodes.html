<html>

<head>
	<script src="/assets/jquery.min.js"></script>
	<link rel="stylesheet" href="/assets/jquery-ui.css">
	<script src="/assets/jquery-ui.js"></script>
	<script src="/assets/distLogo.js"></script>
	<link rel="stylesheet" href="/assets/circle.css">
	<link rel="stylesheet" href="/assets/picluster-iframe.css">
	<script>
		function exec() {
			var div = document.getElementById('modal-body2');

			div ? div.innerHTML = div.innerHTML + '<br><p align=center><img heigth="200" width="200" src="/assets/images/searching.jpg"><br><font size=+3><label>Searching for nodes</label></font>' : false;

			$.get("/nodes?token=" + parent.token, function(data) {
				var check_data = data;

				div.innerHTML = div ? '' : false;

				for (var i in check_data.data) {
					if (div) {
						var dist = (check_data.data[i].os_type || '').toLowerCase();

						div.innerHTML += '<br><br><p align=left>' + distLogo(dist) + '</p><br><font size=+1 style="white-space: pre-wrap;"><b>' + check_data.data[i].hostname + '</b><br>' + "</font>";

						var div0 = document.createElement('div0').addClass('page');
						var div1 = document.createElement('div1').addClass('clearfix').attr('id', 'div1');
						var div2 = document.createElement('div2').addClass('c100 p' + Math.round(check_data.data[i].disk_percentage) + ' small').attr('id', 'running-class');
						div2.innerHTML = '<span id="' + check_data.data[i] + '">' + Math.round(check_data.data[i].disk_percentage) + '%</span>';
						var div3 = document.createElement('div3').addClass('slice');
						var div4 = document.createElement('div4').addClass('bar');
						var div5 = document.createElement('div5').addClass('fill');

						var div6 = document.createElement('div6').addClass('page');
						var div7 = document.createElement('div7').addClass('clearfix').attr('id', 'div7');
						var div8 = document.createElement('div8').addClass('c100 p' + Math.round(check_data.data[i].cpu_percent / check_data.data[i].cpu_cores) + ' small').attr('id', 'running-class');
						div8.innerHTML = '<span id="' + i + '">' + Math.round(check_data.data[i].cpu_percent / check_data.data[i].cpu_cores) + '%</span>';
						var div9 = document.createElement('div9').addClass('slice');
						var div10 = document.createElement('div10').addClass('bar');
						var div11 = document.createElement('div11').addClass('fill');

						var div12 = document.createElement('div12').addClass('page');
						var div13 = document.createElement('div13').addClass('clearfix').attr('id', 'div13');
						var div14 = document.createElement('div14').addClass('c100 p' + check_data.data[i].memory_percentage + ' small').attr('running-class');
						div14.innerHTML = '<span id="' + i + '">' + check_data.data[i].memory_percentage + '%</span>';
						var div15 = document.createElement('div15').addClass('slice');
						var div16 = document.createElement('div16').addClass('bar');
						var div17 = document.createElement('div17').addClass('fill');

						for(var i = 0; i < 5; i++) {
							div[i].appendChild(div[i + 1]);
						}

						for(var i = 6; i < 11; i++) {
							div[i].appendChild(div[i + 1]);
						}

						for(var i = 12; i < 17; i++) {
							div[i].appendChild(div[i + 1]);
						}

						var table = document.createElement("TABLE");
						var row = table.insertRow(0);
						var cell1 = row.insertCell(0);
						var cell2 = row.insertCell(1);
						var cell3 = row.insertCell(2);
						cell1.innerHTML += '<font size="+0" color="black"><b>Disk Usage</b>';
						cell2.innerHTML += '<font size="+0" color="black"><b>CPU Usage</b>';
						cell3.innerHTML += '<font size="+0" color="black"><b>Memory Usage</b>';
						cell1.appendChild(div0);
						cell2.appendChild(div6);
						cell3.appendChild(div12);
						div.appendChild(table);
					}
				}
				addFontLinux();
			});
		}

		exec();
	</script>
</head>

<body>
	<div id="output" class="modal">
		<div class="modal-content2">
			<div class="modal-header">
				<span class="close">&times;</span>
				<h2>PiCluster Nodes</h2>
			</div>
			
			<div id="modal-body2" class="modal-body">
				<p align=center></p>
			</div>
		</div>
	</div>

	<script>
		var output_modal = document.getElementById('output');
		var output_span = document.getElementsByClassName("close")[0];

		output_span.onclick = function() {
			output_modal.style.display = "none";
		}

		output_modal.style.display = "block";

		exec()
	</script>
</html>
